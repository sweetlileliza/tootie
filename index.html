<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tootie‚Äôs Memory Garden üå∏</title>
  <style>
    body {
      font-family: "Comic Sans MS", cursive;
      background: linear-gradient(180deg, #fff7fa 0%, #ffeef8 100%);
      color: #444;
      text-align: center;
      padding: 20px;
      overflow: hidden;
      position: relative;
    }
    h1 { font-size: 2em; color:#ff70a6; margin-bottom:10px; }

    /* intro modal */
    #introModal {
      position: fixed; inset: 0;
      background: rgba(255,240,245,0.95);
      display: none;
      align-items: center; justify-content: center;
      z-index: 9999;
    }
    .modal-content {
      background: white;
      border: 3px solid #ffd6e8;
      border-radius: 20px;
      max-width: 640px;
      padding: 20px 26px;
      box-shadow: 0 4px 20px rgba(255,182,193,0.4);
      color: #704050;
      text-align: left;
    }
    .modal-content p { margin: 8px 0; line-height: 1.45; }
    .modal-content button {
      background: #ffb6c1; border: none; border-radius: 12px;
      padding: 10px 16px; margin-top: 12px; cursor: pointer; font-weight: 700;
    }
    .modal-content button:hover { background:#ff8fb0; }

    /* layout */
    .main-container {
      display:flex; flex-wrap:wrap; justify-content:center; gap:20px;
      margin-top: 18px; position: relative; z-index: 5;
    }

    /* tootie box */
    .tamagotchi-box {
      background: #fff5fa;
      border: 3px solid #ffc6d9;
      border-radius: 20px;
      padding: 16px;
      width: 340px;
      box-shadow: 0 5px 15px rgba(255,182,193,0.3);
    }
    .tootie {
        width: 35vw; /* takes up 35% of the viewport width */
  max-width: 220px; /* prevents her from becoming too big on large screens */
  height: auto; /* keeps proportions */
  aspect-ratio: 1 / 1; /* keeps her square if height:auto doesn't apply perfectly */
  background: url('tootieidle.gif') center/contain no-repeat;
  margin: 6px auto;
  border-radius: 12px;
  transition: transform .22s ease;
    }

    /* stat bars */
    .bars { text-align:left; margin:12px 0; }
    .bar-group { margin: 8px 0; }
    .bar-label {
      font-size: 14px;
      font-weight: bold;
      color: #77485f;
      margin-bottom: 3px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .bar {
      background:#ffe1eb;
      border-radius:10px;
      height:14px;
      overflow:hidden;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }
    .bar-inner { height:100%; border-radius:10px; transition: width .4s ease; }
    .bar-hunger .bar-inner{ background:#ffb3b3; }
    .bar-sleep .bar-inner{ background:#b3d9ff; }
    .bar-happiness .bar-inner{ background:#ffd480; }

    .tamagotchi-actions { display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin-top:8px; }
    .tamagotchi-actions button {
      background:#ffb6c1; border:none; border-radius:10px; padding:8px 12px; cursor:pointer; font-weight:700;
    }
    .tamagotchi-actions button:hover{ background:#ff9cb6; }

    .speech {
      background:#fff; border:2px dashed #ffb6c1; border-radius:12px; padding:8px; margin-top:10px;
      font-style:italic; min-height:44px; display:flex; align-items:center; justify-content:center;
    }

    /* memory form */
    .memory-form {
      position: fixed; bottom: 18px; right: 18px; z-index: 8;
      background: #fff; border:2px solid #ffd6e8; border-radius:12px; padding:12px;
      box-shadow: 0 3px 10px rgba(255,182,193,0.28);
      width: 280px;
    }
    .memory-form input, .memory-form textarea {
      width:100%; box-sizing:border-box; margin:6px 0; padding:8px; border-radius:8px; border:1px solid #ffb6c1;
      font-family: inherit;
    }
    .memory-form button { width:100%; margin-top:6px; background:#ffb6c1; border:none; padding:10px; border-radius:8px; cursor:pointer; font-weight:700; }
    .memory-form button:hover { background:#ff8fb0; }

    /* hearts container */
    #hearts-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      pointer-events: none;
      z-index: 999; /* increased so hearts stay above all elements */
    }

.heart {
  position: absolute;
  bottom: 0;
  font-size: 1rem;
  opacity: 0.9;
  color: #ffb6c1;
  text-shadow: 0 0 5px rgba(255, 182, 193, 0.8);
  animation: floatUp linear infinite;
  max-width: 90vw; /* keeps hearts within screen width */
  white-space: normal; /* allows wrapping */
  word-wrap: break-word; /* breaks long words if needed */
  text-align: center; /* keeps text looking nice */
  left: 50%; /* center horizontally */
  transform: translateX(-50%); /* true center alignment */
}


    @keyframes floatUp {
      0% { transform: translateY(0); opacity: 0.8; }
      100% { transform: translateY(-110vh); opacity: 0; }
    }

    @media (max-width:720px) {
      .main-container { flex-direction:column; align-items:center; }
      .tamagotchi-box { width: 92%; max-width:360px; }
      .memory-form { right: 12px; left: 12px; bottom: 12px; width:auto; }
    }
  </style>
</head>
<body>
  <h1>üå∏ Tootie‚Äôs Memory Garden üå∏</h1>

  <div id="introModal" aria-hidden="true">
    <div class="modal-content">
      <p>Hi! When I was five years old, I fell in love with a little puppy plush that had been gifted to my newborn brother...and I promptly stole it! That tiny pup plush, lovingly named <strong>Tootie</strong>, was my closest companion for eight years, until one day she was stolen. :(</p>
      <p>As heartbreaking as that loss was, I now look back with gratitude for having something I truly loved during my childhood. In her memory (and in honor of the toys and moments that shaped us), I created this space.</p>
      <p>Please treat Tootie with care, and warm someone‚Äôs day by sharing a short childhood memory below. You can "ask" Tootie to share someone's precious memory!</p>
      <button id="closeModal">Close üíï</button>
    </div>
  </div>

  <div class="main-container">
    <div class="tamagotchi-box">
      <h2>üêæ Meet Tootie!</h2>
      <div class="tootie" id="tootieImg"></div>

      <div class="bars">
        <div class="bar-group">
          <div class="bar-label">üç™ Hunger</div>
          <div class="bar bar-hunger"><div id="hunger-bar" class="bar-inner"></div></div>
        </div>
        <div class="bar-group">
          <div class="bar-label">üò¥ Sleep</div>
          <div class="bar bar-sleep"><div id="sleep-bar" class="bar-inner"></div></div>
        </div>
        <div class="bar-group">
          <div class="bar-label">üíï Happiness</div>
          <div class="bar bar-happiness"><div id="happy-bar" class="bar-inner"></div></div>
        </div>
      </div>

      <div class="tamagotchi-actions">
        <button id="feedBtn">üç™ Feed</button>
        <button id="petBtn">üíï Pet</button>
        <button id="askBtn">ü´∂ Ask</button>
        <button id="sleepBtn">üò¥ Sleep</button>
      </div>

      <div class="speech" id="speech">Tootie is waiting for you...</div>
    </div>
  </div>

  <div class="memory-form">
    <input id="nameInput" placeholder="Your name (optional)">
    <textarea id="memoryInput" placeholder="A short childhood memory..." rows="2"></textarea>
    <button id="sendMemory">Send üíå</button>
  </div>

  <div id="hearts-container" aria-hidden="true"></div>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <script>
  const firebaseConfig = {
    apiKey: "AIzaSyBx0FIDSLWR1KsKLi7x0DmuDS6KQX55gIg",
    authDomain: "tuti-memory-jar.firebaseapp.com",
    databaseURL: "https://tuti-memory-jar-default-rtdb.firebaseio.com",
    projectId: "tuti-memory-jar",
    storageBucket: "tuti-memory-jar.firebasestorage.app",
    messagingSenderId: "391826622043",
    appId: "1:391826622043:web:c8688ad3ce95d28fc6a17e"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const modal = document.getElementById('introModal');
  const closeModalBtn = document.getElementById('closeModal');
  if (!localStorage.getItem('seenIntro')) modal.style.display = 'flex';
  closeModalBtn.addEventListener('click', () => {
    modal.style.display = 'none';
    localStorage.setItem('seenIntro', 'true');
  });

  const hungerBar = document.getElementById('hunger-bar');
  const sleepBar = document.getElementById('sleep-bar');
  const happyBar  = document.getElementById('happy-bar');
  const speechEl  = document.getElementById('speech');
  const tootieImg = document.getElementById('tootieImg');

  let hunger = parseInt(localStorage.getItem('tootie_hunger')) || 70;
  let sleepVal = parseInt(localStorage.getItem('tootie_sleep')) || 70;
  let happiness = parseInt(localStorage.getItem('tootie_happy')) || 80;

  function updateBars() {
    hungerBar.style.width = hunger + '%';
    sleepBar.style.width = sleepVal + '%';
    happyBar.style.width  = happiness + '%';
  }
  function saveStats() {
    localStorage.setItem('tootie_hunger', hunger);
    localStorage.setItem('tootie_sleep', sleepVal);
    localStorage.setItem('tootie_happy', happiness);
  }
  function speak(text) {
    speechEl.textContent = text;
    tootieImg.style.transform = 'scale(1.07)';
    setTimeout(()=> tootieImg.style.transform = 'scale(1)', 400);
  }

 function changeTootieGif(gif) {
  tootieImg.style.background = `url('${gif}') center/contain no-repeat`;

  // If it's the sleep GIF, make it last longer
  const duration = gif.includes('sleep') ? 5000 : 2000;

  setTimeout(() => {
    tootieImg.style.background = `url('tootieidle.gif') center/contain no-repeat`;
  }, duration);
}

  document.getElementById('feedBtn').addEventListener('click', () => {
    hunger = Math.min(100, hunger + 15);
    happiness = Math.min(100, happiness + 5);
    speak('Yum! Tootie loves the treat!');
    changeTootieGif('tootieeat.gif');
    updateBars(); saveStats();
  });
  document.getElementById('petBtn').addEventListener('click', () => {
    happiness = Math.min(100, happiness + 12);
    speak('Purr ‚Äî Tootie loves cuddles!');
    changeTootieGif('tootiepet.gif');
    updateBars(); saveStats();
  });
  document.getElementById('sleepBtn').addEventListener('click', () => {
    sleepVal = Math.min(100, sleepVal + 20);
    happiness = Math.max(0, happiness - 5);
    speak('Zzz... Tootie is napping.');
    changeTootieGif('tootiesleep.png');
    updateBars(); saveStats();
  });

  document.getElementById('askBtn').addEventListener('click', () => {
    const ref = db.ref('memories');
    ref.once('value', snapshot => {
      const data = snapshot.val();
      if (!data) {
        speak('No memories yet ‚Äî be the first to share one üíï');
        return;
      }
      const list = Object.values(data);
      const pick = list[Math.floor(Math.random()*list.length)];
      const memoryText = pick.text || pick.memory || pick.msg || '';
      const name = pick.name || 'Someone';
      speak(`"${memoryText}" ‚Äî ${name}`);
      changeTootieGif('tootieask.gif');
      happiness = Math.min(100, happiness + 6);
      updateBars(); saveStats();
    });
  });

  // gradual decay
  setInterval(() => {
    hunger = Math.max(0, hunger - 0.2);
    sleepVal = Math.max(0, sleepVal - 0.1);
    happiness = Math.max(0, happiness - 0.12);
    updateBars(); saveStats();
  }, 5000);
  updateBars();

  // aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
  const heartsContainer = document.getElementById('hearts-container');
  const activeHearts = new Set();

  function spawnHeart(mem) {
    if (!mem || !mem.text || activeHearts.has(mem.text)) return;
    activeHearts.add(mem.text);
    const heart = document.createElement('div');
    heart.className = 'heart';
    heart.textContent = `üíñ ${mem.text}`;
    heart.style.left = Math.random() * 90 + '%';
    heart.style.animationDuration = 8 + Math.random() * 10 + 's';
    heart.style.fontSize = 0.8 + Math.random() * 0.6 + 'rem';
    heartsContainer.appendChild(heart);
   // setTimeout(() => {
     // heart.remove();
      //activeHearts.delete(mem.text);
    //}, 18000);
  }

  db.ref('memories').limitToLast(30).once('value', (snapshot) => {
    const data = snapshot.val() || {};
    Object.values(data).forEach(spawnHeart);
  });
  db.ref('memories').on('child_added', (snap) => spawnHeart(snap.val()));

  // bc firebase gaand mrae
  document.getElementById('sendMemory').addEventListener('click', () => {
    const name = document.getElementById('nameInput').value.trim() || "Anonymous";
    const text = document.getElementById('memoryInput').value.trim();
    if (!text) return;
    db.ref('memories').push({ name, text, timestamp: Date.now() });
    document.getElementById('memoryInput').value = '';
    speak('Tootie thanks you for your memory üíï');
  });
  </script>
</body>
</html>
